CC = @CXX@ # c compiler
CXXFLAGS = -O2 -ansi -W -Wall -fPIC -std=c++11 -c # c flags
LDFLAGS = -shared
ROOTLIBS = -lRIO -lNet -lHist -lTree -lMatrix -lMathCore -lThread -lPhysics -lPyROOT -lMinuit -lMinuit2 -lGpad # root libraries

#boost
#BOOST_INC = /usr/local/include
#BOOST_LIB = /usr/local/lib
BOOSTLIBS = -lboost_python

BOOST_INC = /cvmfs/sft.cern.ch/lcg/external/Boost/1.53.0_python2.7/x86_64-slc6-gcc48-opt/include
BOOST_LIB = /cvmfs/sft.cern.ch/lcg/external/Boost/1.53.0_python2.7/x86_64-slc6-gcc48-opt//lib

RM = rm -f # rm command
TARGET_LIB = libJawa.so # target lib

ROOTLIBDIR = @ROOTLIBDIR@
ROOTINCDIR = @ROOTINCDIR@
PYTHON_INCLUDE_DIR = @PYTHON_INCLUDE_DIR@
PYTHON_CPP_FLAGS   = @PYTHON_CPPFLAGS@

SRCS = JawaObj.cxx Expr.cxx Var.cxx Var2D.cxx Var3D.cxx EffVar.cxx EffVar2D.cxx ReweightVar.cxx Template.cxx MWTemplate.cxx Fitter.cxx Tree.cxx EntryList.cxx Eff.cxx EfficiencyClass.cxx AnalysisClass.cxx Tune.cxx Tune2D.cxx Utils.cxx

SRCS += pyboost.cxx
CXXFLAGS += -DWITHPYTHON
PREFIX = @prefix@

vpath %.o lib/

OBJS = $(SRCS:.cxx=.o)

all	: ${TARGET_LIB}

$(TARGET_LIB) : $(OBJS)
	$(CC) $(LDFLAGS) $^ $(BOOSTLIBS) -L$(ROOTLIBDIR) $(ROOTLIBS) -o lib/$@ 
$(OBJS): %.o:src/%.cxx include/%.h
	$(CC) $(CXXFLAGS) -Isrc/ -I/usr/include -Iinclude -I$(ROOTINCDIR) $(PYTHON_CPP_FLAGS) -I$(BOOST_INC) $< -o lib/$@

clean	: 
	-${RM} lib/${TARGET_LIB} ${OBJS}
